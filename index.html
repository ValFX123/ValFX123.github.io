<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>SourMarket – Unique Custom Items & Gifts</title>
  <meta name="description" content="SourMarket – Get unique custom necklaces, chains, skateboards, pillows, keychains, re-textures, and more! 100% custom, 100% YOU.">
  <meta name="theme-color" content="#ff5ea7">
  <meta property="og:title" content="SourMarket – Custom Items, Gifts, & More!">
  <meta property="og:description" content="Get unique custom necklaces, chains, skateboards, pillows, keychains, re-textures, and more. Secure PayPal payments. Discord support.">
  <meta property="og:image" content="https://i.imgur.com/KcfZIqA.png">
  <link rel="icon" type="image/png" href="https://i.imgur.com/KcfZIqA.png">
  <link href="https://fonts.googleapis.com/css?family=Montserrat:700,400|Orbitron:800&display=swap" rel="stylesheet">
  <style>
    :root {
      --pink1: #fff6fa;
      --pink2: #ffe4ec;
      --pink3: #ffb6e0;
      --pink4: #ffa1d7;
      --pink5: #ff5ea7;
      --pink6: #c92d70;
      --green: #2fc764;
      --white: #fff;
      --shadow: 0 8px 32px 0 #ff5ea71c;
      --transition: .16s cubic-bezier(.38,1.6,.62,1);
      --star: #FFD600;
    }
    html { scroll-behavior: smooth;}
    body {
      font-family: 'Montserrat', Arial, sans-serif;
      background: linear-gradient(120deg, var(--pink1), var(--pink2) 90%);
      margin: 0;
      color: #3b2440;
      min-height: 100vh;
      scroll-behavior: smooth;
      overflow-x: hidden;
      transition: background 0.6s;
    }
    header {
      position: sticky; top: 0; z-index: 100;
      background: rgba(255, 244, 250, 0.98);
      box-shadow: var(--shadow);
      display: flex; align-items: center; justify-content: space-between;
      padding: 0.85rem 2.4rem 0.85rem 1.2rem;
      border-bottom: 2.5px solid #ffb6e04a;
      transition: background .25s;
    }
    .logo {
      font-family: 'Orbitron', sans-serif;
      font-weight: 800;
      font-size: 2rem;
      color: var(--pink6);
      display: flex; align-items: center;
      letter-spacing: 2px;
      gap: 0.7em;
      user-select: none;
    }
    .logo img {
      width: 44px; height: 44px; border-radius: 50%; border: 3.5px solid var(--pink4); background: #fff;
      box-shadow: 0 2px 12px #ffa8ce37;
    }
    nav { display: flex; gap: 2rem; align-items: center;}
    nav a {
      color: var(--pink6);
      text-decoration: none;
      font-weight: 700;
      font-size: 1.1rem;
      padding: 0.38em 0.93em;
      border-radius: 1em;
      transition: background var(--transition), color var(--transition);
      position: relative;
      outline: none;
      letter-spacing:0.02em;
    }
    nav a.active, nav a:focus, nav a:hover {
      background: var(--pink4);
      color: var(--white);
    }
    main { padding: 3.3rem 1rem 2.7rem 1rem; max-width: 1100px; margin: 0 auto; }
    section {
      margin-bottom: 3.8rem;
      opacity: 0;
      transform: translateY(30px);
      transition: opacity .55s cubic-bezier(.37,2,.54,.97), transform .52s cubic-bezier(.37,2,.54,.97);
    }
    section.visible {
      opacity: 1 !important;
      transform: translateY(0) !important;
    }
    h1, h2, h3 { font-family: 'Orbitron', sans-serif; color: var(--pink6); }
    h1 { font-size: 2.4rem; margin-top: 1.7rem; letter-spacing:1px;text-shadow:0 2px 12px #ffe4ec80;}
    .section-title { font-size:2.05rem;margin-bottom:2rem;text-align:center;letter-spacing:1.5px;text-shadow:0 2px 10px #ffe4ec44;}
    .stats {
      display: flex; justify-content: center; gap: 2.6rem; flex-wrap: wrap;
      margin: 2.4rem 0 1.9rem 0;
    }
    .stat {
      text-align: center;
      background: var(--white);
      border-radius: 1.4em;
      box-shadow: var(--shadow);
      padding: 1.12rem 2.1rem;
      min-width: 115px;
      opacity: 0;
      transform: translateY(25px);
      animation: statFade .7s .12s forwards;
    }
    .stat .num { font-size: 2.25rem; font-weight: 900; color: var(--pink5);}
    .stat .label { font-size: 1.06rem; color: #a85a7c; }
    .btn, button, input[type=button] {
      background: linear-gradient(92deg, var(--pink5) 42%, var(--pink4) 92%);
      color: #fff;
      border: none;
      border-radius: 1.22em;
      font-weight: bold;
      font-size: 1.13rem;
      padding: 0.78em 2.2em;
      cursor: pointer;
      box-shadow: 0 2px 12px 0 #ffc8df2c;
      outline:none;
      transition: background var(--transition), transform .13s, box-shadow .14s;
    }
    .btn:hover, button:hover, input[type=button]:hover {
      background: linear-gradient(92deg, var(--pink6) 33%, var(--pink4) 92%);
      transform: scale(1.07);
      box-shadow: 0 4px 16px 0 #ffa1d73c;
    }
    .products-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px,1fr));
      gap: 2.2rem;
      margin-top: 1.2rem;
    }
    .product-card {
      background: var(--white);
      border-radius: 1.3em;
      box-shadow: 0 6px 28px 0 #ff5ea718;
      padding: 1.5rem 1.2rem 1.6rem 1.2rem;
      text-align: center;
      cursor: pointer;
      transition: box-shadow .18s, transform .18s;
      position: relative;
      overflow: hidden;
      opacity: 0;
      transform: translateY(45px) scale(.96);
      animation: prodFade .8s forwards;
      border: 2.5px solid #fff;
    }
    .product-card:hover {
      transform: scale(1.065) translateY(-4px);
      box-shadow: 0 12px 38px 2px #ffb6e032;
      z-index: 2;
      border:2.5px solid var(--pink4);
      filter: brightness(1.03);
    }
    .product-card .icon, .product-card .prod-img {
      width: 68px; height: 68px;
      margin-bottom: 1em;
      border-radius: 14px;
      object-fit: cover;
      box-shadow: 0 4px 12px #ffa8ce31;
      background: #ffe4ec;
      border: 2px solid var(--pink4);
      animation: iconPulse 2.5s infinite alternate;
    }
    @keyframes iconPulse {
      0% { filter: drop-shadow(0 2px 7px #ffa8ce37);}
      100% { filter: drop-shadow(0 7px 20px #ff5ea72c);}
    }
    .product-title { font-weight: 800; color: var(--pink6); font-size: 1.26rem;margin-bottom:0.1em;}
    .product-price { color: var(--pink5); font-size: 1.19rem; font-weight: bold;}
    .product-stock { color: #a971a1; font-size: 0.93em; }
    .product-card .btn {
      font-size: 1.07em; margin-top: 1.23em;
      width: 95%;
      padding: 0.85em 0;
      letter-spacing:0.03em;
      box-shadow:0 2px 12px #ff5ea71c;
    }
    .product-desc {
      color: #813a74;
      font-size: 0.99em;
      margin: 0.63em 0 0.09em 0;
      min-height: 2.2em;
    }
    /* Modal - solid background */
    .modal-bg, .pay-popup-bg {
      position: fixed; top:0; left:0; width:100vw; height:100vh;
      background: #fff;
      display: flex; align-items: center; justify-content: center;
      z-index: 1111;
    }
    .modal, .pay-popup {
      background: var(--white);
      border-radius: 1.4em;
      max-width: 430px;
      min-width: 320px;
      padding: 2.1rem 1.7rem 2.5rem 1.7rem;
      box-shadow: 0 8px 44px 2px #ffb6e059;
      text-align: center;
      position: relative;
      animation: pop .22s cubic-bezier(.4,2,.7,1) 1;
    }
    @keyframes pop { 0% {transform: scale(.92);} 100% {transform: scale(1);} }
    .modal-close {
      position: absolute; right: 1.12em; top: 1.12em;
      font-size: 1.8rem; color: var(--pink5); background: none; border: none; cursor: pointer;
      line-height: 1;
    }
    .modal-title { font-size: 1.18rem; font-weight: bold; color: var(--pink6); margin-bottom: 0.15em;}
    .modal-desc { color: #803667; font-size: 1.03rem; margin-bottom: 0.36em;}
    .modal .product-price { font-size: 1.09rem;}
    .modal .btn { font-size: 1.09em; margin-top: 1.5em; width: 90%; padding: 0.83em 0;}
    .pay-popup h2 {color:#c92d70;font-family:'Orbitron',sans-serif;font-size:1.17em;margin-bottom:.4em;}
    .pay-popup p {color:#813a74;font-size:1.04em;line-height:1.6;}
    .pay-popup button, .pay-popup a {margin-top:1.4em;}
    .pay-popup .spinner {width:38px;height:38px;border:5px solid #ffb6e0;border-top:5px solid #c92d70;border-radius:50%;margin:1.1em auto 0 auto;animation:spin 1s linear infinite;}
    @keyframes spin { to {transform:rotate(360deg);} }
    .pay-popup .bigcheck {
      font-size:2.8em;
      color:var(--green);
      margin-bottom:0.48em;
      display:inline-block;
    }
    /* Confetti */
    .confetti {position:fixed;pointer-events:none;left:0;top:0;width:100vw;height:100vh;z-index:9999;}
    /* Reviews */
    .reviews-list {
      margin: 2.2em 0 0 0;
      display: flex; flex-direction: column; gap: 1.2em;
      max-width: 650px; margin-left: auto; margin-right: auto;
    }
    .review-card {
      background: var(--white);
      border-radius: 1em;
      box-shadow: 0 2px 16px #ffb6e033;
      padding: 1.1em 1.35em 1.2em 1.35em;
      display: flex; flex-direction: column;
      gap: 0.5em;
      border-left: 6px solid var(--pink4);
      position: relative;
      opacity: 0;
      transform: translateY(24px);
      animation: reviewFade .7s forwards;
    }
    .reviewer {
      font-weight: bold; color: var(--pink5);
      font-size: 1.07em;
      display: flex; align-items: center; gap:0.6em;
    }
    .review-rating svg {height:1.13em;width:1.13em;margin-right:0.05em;vertical-align:-2px;}
    .review-rating .star-empty {fill:#ffe4ec;}
    .review-rating .star-full {fill:var(--star);filter:drop-shadow(0 2px 4px #ffd60060);}
    .review-text {
      color: #6e3171;
      font-size: 1.03em;
    }
    .review-date {
      font-size:0.93em; color:#d8b1c5;
    }
    .review-form {
      background: var(--pink2);
      border-radius: 1.2em;
      box-shadow: 0 2px 16px #ffb6e019;
      padding: 1.1em 1.2em;
      margin: 2.1em auto 0 auto;
      max-width: 440px;
      display: flex; flex-direction: column; gap: 0.6em;
    }
    .review-form input, .review-form textarea, .review-form select {
      font-family: inherit;
      font-size: 1em;
      padding: 0.55em 0.7em;
      border-radius: 0.6em;
      border: 1.5px solid var(--pink3);
      background: #fff;
      color: #6e3171;
      outline: none;
      resize: none;
      transition: border-color .13s;
    }
    .review-form input:focus, .review-form textarea:focus, .review-form select:focus {
      border-color: var(--pink5);
    }
    .review-form label { font-weight: bold; color: var(--pink6); font-size: 1em;}
    .review-form button {
      margin-top:0.5em;align-self:flex-end;min-width:130px;
    }
    .review-form .err { color:var(--pink6); font-size:0.98em; margin:0.2em 0;}
    /* Back to Top Button */
    #top-btn {
      display: none;
      position: fixed;
      bottom: 82px;
      right: 26px;
      z-index: 2222;
      background: linear-gradient(92deg, var(--pink5) 42%, var(--pink4) 92%);
      color: #fff;
      border-radius: 50%;
      border: none;
      width: 44px;
      height: 44px;
      font-size: 1.4em;
      box-shadow: 0 2px 12px 0 #ffa1d773;
      cursor: pointer;
      transition: background .14s, transform .13s;
    }
    #top-btn:hover { background: linear-gradient(92deg, var(--pink6) 33%, var(--pink4) 92%); transform:scale(1.10);}
    /* FAQ */
    .faq-box {
      max-width: 630px;
      margin: 2.8em auto 1.3em auto;
      background: var(--pink2);
      border-radius: 1em;
      padding: 1.1em 1.3em;
      box-shadow: 0 2px 12px #ffb6e011;
    }
    .faq-title {font-family:'Orbitron',sans-serif;font-size:1.12em;font-weight:700;color:var(--pink5);margin-bottom:.7em;}
    .faq-q {color:var(--pink6);font-weight:bold;cursor:pointer;display:flex;align-items:center;justify-content:space-between;padding:.6em 0;}
    .faq-a {display:none;color:#6e2a63;font-size:1.03em;padding:0 0 .8em 0;}
    .faq-q.active + .faq-a{display:block;}
    /* Admin Panel */
    .admin-panel {
      position:fixed;bottom:18px;right:20px;z-index:3300;
      background:#fff6faee;
      border:2px solid var(--pink3);
      border-radius:1.2em;
      padding:1.2em 1.6em 1.3em 1.6em;
      box-shadow:0 4px 32px #ffc8df3c;
      color:var(--pink6);
      font-size:1.07em;
      display:none;
      flex-direction:column;gap:.75em;
      min-width:230px;
      text-align:left;
      animation:pop .25s;
    }
    .admin-panel label{font-weight:bold;}
    .admin-panel .btn{font-size:1em;padding:.48em 1.1em;}
    .admin-toggle{
      position:fixed;bottom:18px;right:20px;z-index:3299;
      background:linear-gradient(90deg,var(--pink5),var(--pink4));
      color:#fff;
      font-size:1.3em;
      border-radius:50%;
      width:42px;height:42px;
      box-shadow:0 2px 12px #ffa1d73a;
      cursor:pointer;
      display:flex;align-items:center;justify-content:center;
      outline:none;border:none;
      transition:background .17s, opacity .16s;
      opacity:0.5;
    }
    .admin-toggle:hover{background:linear-gradient(90deg,var(--pink6),var(--pink4));opacity:1;}
    @media (max-width: 650px) {
      header {flex-direction:column;gap:0.7em;padding:0.8rem;}
      .stats { gap: 1.15rem;}
      .products-grid { gap: 1.12rem;}
      .modal { padding: 1.1rem 0.6rem 1.4rem 0.6rem;}
      .review-form { padding:0.7em 0.4em;}
      .review-card { padding:0.85em 0.7em;}
      .pay-popup, .modal {min-width:0;max-width:96vw;}
      .admin-panel{right:6px;min-width:160px;}
      .admin-toggle{right:6px;}
      #top-btn{bottom:70px;right:12px;}
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">
      <img src="https://i.imgur.com/KcfZIqA.png" alt="SourMarket logo">
      SourMarket
    </div>
    <nav>
      <a href="#home" class="active" onclick="switchSection('home');return false;">Home</a>
      <a href="#products" onclick="switchSection('products');return false;">Products</a>
      <a href="#reviews" onclick="switchSection('reviews');return false;">Reviews</a>
    </nav>
  </header>
  <main>
    <section id="home" style="margin-top:2em;">
      <h1>Welcome to <span style="color: var(--pink5)">SourMarket</span>!</h1>
      <p style="max-width:590px;margin:auto;font-size:1.21rem;line-height:1.67;color:#6e2a63;margin-top:1.18em;">
        We specialize in unique custom items for everyone! <br>
        <b>Necklaces, chains, skateboards, pillows, keychains, re-textures, custom orders, and more!</b><br>
        <span style="color: var(--pink5);font-weight:600;">Mix & Match available.</span> Surprise yourself or create a ticket for a one-of-a-kind request.
      </p>
      <div class="stats">
        <div class="stat"><div class="num" id="stat-sold">32</div><div class="label">PRODUCTS SOLD</div></div>
        <div class="stat"><div class="num" id="stat-customers">14</div><div class="label">TOTAL CUSTOMERS</div></div>
        <div class="stat"><div class="num" id="stat-reviews">0</div><div class="label">REVIEWS RECEIVED</div></div>
        <div class="stat"><div class="num" id="stat-rating">0.00</div><div class="label">AVERAGE RATING</div></div>
      </div>
      <div style="text-align:center; margin-top:2.2em;">
        <button class="btn" onclick="switchSection('products');window.scrollTo(0,0);">View Products</button>
      </div>
    </section>
    <section id="products" style="display:none;">
      <div class="section-title">Our Products</div>
      <div class="products-grid" id="products-grid"></div>
    </section>
    <section id="reviews" style="display:none;">
      <div class="section-title">Customer Reviews</div>
      <div class="reviews-list" id="reviews-list">
        <div style="text-align:center; color:#a971a1; font-size:1.13em;">No reviews yet. Be the first!</div>
      </div>
      <form class="review-form" id="review-form" autocomplete="off" onsubmit="return addReview(event)">
        <label for="review-name">Your Name:</label>
        <input id="review-name" name="name" type="text" maxlength="20" required placeholder="Name">
        <label for="review-rating">Rating:</label>
        <select id="review-rating" name="rating" required>
          <option value="5">5 - Excellent!</option>
          <option value="4">4 - Good</option>
          <option value="3">3 - Okay</option>
          <option value="2">2 - Bad</option>
          <option value="1">1 - Awful</option>
        </select>
        <label for="review-text">Your Review:</label>
        <textarea id="review-text" name="review" rows="3" maxlength="300" required placeholder="Write your experience here..."></textarea>
        <div class="err" id="review-error"></div>
        <button type="submit" class="btn">Submit Review</button>
      </form>
    </section>
    <div class="faq-box" id="faq">
      <div class="faq-title">FAQ</div>
      <div class="faq-q" onclick="toggleFaq(this)">How do I pay for a product? <span>+</span></div>
      <div class="faq-a">Click “Pay Here!” on your chosen product, follow the instructions, and complete payment using PayPal’s “Friends & Family” option.</div>
      <div class="faq-q" onclick="toggleFaq(this)">How do I get my product? <span>+</span></div>
      <div class="faq-a">After payment, you’ll be given a link to our Discord for instant delivery or support!</div>
      <div class="faq-q" onclick="toggleFaq(this)">Can I make a custom order? <span>+</span></div>
      <div class="faq-a">Yes! Choose “Custom Orders” in Products or message us on Discord for a quote and design chat.</div>
    </div>
  </main>
  <!-- Modal for product details -->
  <div id="product-modal-bg" class="modal-bg" style="display:none;">
    <div class="modal" id="product-modal">
      <button class="modal-close" onclick="closeModal()">&times;</button>
      <div>
        <img class="prod-img" id="prod-img-modal" src="" alt="icon" style="margin-bottom:0.9em;">
      </div>
      <div class="modal-title" id="modal-title"></div>
      <div class="modal-desc" id="modal-desc"></div>
      <div>
        <span class="product-price" id="modal-price"></span>
      </div>
      <div class="product-stock" id="modal-stock"></div>
      <button class="btn" style="margin-top:2em;" onclick="showPayPopup()">Pay Here!</button>
    </div>
  </div>
  <!-- Payment popups -->
  <div id="pay-popup-bg" class="pay-popup-bg" style="display:none;">
    <div id="pay-popup-content"></div>
  </div>
  <!-- Confetti -->
  <canvas class="confetti" id="confetti-canvas" style="display:none"></canvas>
  <!-- Admin Panel -->
  <button class="admin-toggle" id="admin-toggle" title="Admin/Testing" onclick="toggleAdmin()">
    &#9881;
  </button>
  <div class="admin-panel" id="admin-panel">
    <label>Admin Demo Panel</label>
    <button class="btn" onclick="resetStats()">Reset Stats</button>
    <button class="btn" onclick="clearReviews()">Delete All Reviews</button>
    <div style="margin-top:.7em;font-size:.93em;color:#a971a1;">(Visible to you only. <br>For public, remove this section.)</div>
  </div>
  <!-- Back to Top Button -->
  <button id="top-btn" onclick="window.scrollTo({top:0,behavior:'smooth'})">&#8679;</button>
  <script>
    // Product images for each (add your own links if desired)
    const prodImgs = [
      "https://i.imgur.com/42PZXcF.png", // Necklace example
      "https://i.imgur.com/5g5pUN3.png", // Iced Out Chain example
      "https://i.imgur.com/BbHo3L5.png", // Skateboard example
      "https://i.imgur.com/T8sTTrB.png", // Mini Shoulder Pal example
      "https://i.imgur.com/YVGRn88.png", // Mini Avatar Keychain example
      "https://i.imgur.com/GW9XhCQ.png", // Custom pillow small
      "https://i.imgur.com/Bhr7JJQ.png", // Custom pillow big
      "", // Re-Textures (fallback)
      "" // Custom Orders (fallback)
    ];
    // PRODUCTS
    const products = [
      {name:"Necklaces",price:"$10",extra:"Charms are $2-$4 depending on what it is",desc:"Custom necklaces, add your favorite charms!",stock:"∞"},
      {name:"Iced Out Chain",price:"$15",desc:"Super shiny iced out chains to level up any outfit.",stock:"∞"},
      {name:"Skateboard",price:"$15",desc:"Fully customizable skateboard for cruising in style.",stock:"∞"},
      {name:"Mini Shoulder Pal",price:"$15",desc:"A mini plush pal that sits on your shoulder. So cute!",stock:"∞"},
      {name:"Mini Avatar Keychain",price:"$20",desc:"Take your mini avatar anywhere you go, on your keys or bag!",stock:"∞"},
      {name:"Custom pillows - Small",price:"$10",desc:"Small custom pillows for your room or as gifts.",stock:"∞"},
      {name:"Custom pillows - Big",price:"$15",desc:"Big custom pillows for extra comfort and fun.",stock:"∞"},
      {name:"Re-Textures",price:"$20-$50",desc:"Custom re-textures for your favorite items, prices vary.",stock:"∞"},
      {name:"Custom Orders",price:"$10-$100",desc:"Want something totally unique? Send your idea for a custom quote.",stock:"∞"}
    ];
    // STATS
    let stats = JSON.parse(localStorage.getItem("sourmarket_stats") || '{}');
    stats.sold = 32;
    stats.customers = 14;
    let reviews = [];
    let isCustomer = localStorage.getItem("sourmarket_isCustomer") === "1";
    function renderStats() {
      document.getElementById("stat-sold").innerText = stats.sold;
      document.getElementById("stat-customers").innerText = stats.customers;
      document.getElementById("stat-reviews").innerText = reviews.length;
      if (reviews.length === 0) {
        document.getElementById("stat-rating").innerText = "0.00";
      } else {
        let avg = reviews.reduce((sum, r) => sum + Number(r.rating), 0) / reviews.length;
        document.getElementById("stat-rating").innerText = avg.toFixed(2);
      }
    }
    renderStats();
    function renderProducts() {
      const grid = document.getElementById("products-grid");
      grid.innerHTML = "";
      products.forEach((prod, i) => {
        const div = document.createElement("div");
        div.className = "product-card";
        div.style.animationDelay = `${0.06 * i + 0.15}s`;
        const imgSrc = prodImgs[i] || "";
        div.innerHTML = `
          <img src="${imgSrc || 'https://i.imgur.com/KcfZIqA.png'}" class="prod-img" alt="Product image">
          <div class="product-title">${prod.name}</div>
          <div class="product-desc">${prod.desc || ""}</div>
          <div style="margin-top:0.47em;">
            <span class="product-price">${prod.price}</span>
          </div>
          ${prod.extra ? `<div style="font-size:0.98em;color:#c92d70;margin-top:0.2em;">${prod.extra}</div>` : ""}
          <div class="product-stock">In Stock: ${prod.stock}</div>
          <button class="btn" onclick="openModal(${i});event.stopPropagation();">View Details</button>
        `;
        div.onclick = () => openModal(i);
        grid.appendChild(div);
      });
    }
    renderProducts();
    // PRODUCT MODAL
    let selectedProductIdx = 0;
    function openModal(idx) {
      selectedProductIdx = idx;
      const prod = products[idx];
      const imgSrc = prodImgs[idx] || 'https://i.imgur.com/KcfZIqA.png';
      document.getElementById("prod-img-modal").src = imgSrc;
      document.getElementById("modal-title").innerText = prod.name;
      document.getElementById("modal-desc").innerText = prod.desc || "";
      document.getElementById("modal-price").innerText = prod.price + (prod.extra ? " | " + prod.extra : "");
      document.getElementById("modal-stock").innerText = `In Stock: ${prod.stock}`;
      document.getElementById("product-modal-bg").style.display = "flex";
      document.body.style.overflow = "hidden";
      setTimeout(()=>{document.getElementById("product-modal-bg").querySelector('.modal').focus()}, 180);
    }
    function closeModal() {
      document.getElementById("product-modal-bg").style.display = "none";
      document.body.style.overflow = "";
    }
    // PAYMENT POPUP
    function showPayPopup() {
      closeModal();
      showPopupStep1();
    }
    function showPopupStep1() {
      document.getElementById("pay-popup-bg").style.display = "flex";
      document.getElementById("pay-popup-content").innerHTML = `
        <div class="pay-popup">
          <h2>Payment Instructions</h2>
          <ol style="text-align:left;max-width:350px;margin:0 auto 1.1em auto;padding-left:1.2em;color:#803667;font-size:1.05em;">
            <li><b>Friends and Family Only</b></li>
            <li><b>No Notes</b></li>
            <li style="word-break:break-all;"><b>RealEKitten69</b> (PayPal.me)</li>
          </ol>
          <a href="https://www.paypal.me/RealEKitten69" class="btn" target="_blank" onclick="setTimeout(showPayPopupProcessing,1200);">Pay with PayPal</a>
        </div>
      `;
    }
    function showPayPopupProcessing() {
      document.getElementById("pay-popup-content").innerHTML = `
        <div class="pay-popup">
          <h2>Processing Your Payment...</h2>
          <div class="spinner"></div>
          <p style="margin-top:1.4em;color:#b5678b;">Please wait while we verify your payment.</p>
        </div>
      `;
      setTimeout(()=>{
        showPayPopupSuccess();
        confetti();
      }, 1700);
    }
    function showPayPopupSuccess() {
      document.getElementById("pay-popup-content").innerHTML = `
        <div class="pay-popup">
          <span class="bigcheck">&#10003;</span>
          <h2>Payment Completed!</h2>
          <p style="margin-bottom:1.3em;">Thank you for your purchase.<br>Click below to receive your product and chat with support.</p>
          <a href="https://discord.gg/sourmarket" class="btn" target="_blank" onclick="afterBuy()">Get your product</a>
        </div>
      `;
      afterBuy();
    }
    function afterBuy() {
      stats.sold = Number(stats.sold || 0) + 1;
      if (!isCustomer) {
        stats.customers = Number(stats.customers || 0) + 1;
        isCustomer = true;
        localStorage.setItem("sourmarket_isCustomer", "1");
      }
      renderStats();
      localStorage.setItem("sourmarket_stats", JSON.stringify(stats));
    }
    document.getElementById("pay-popup-bg").onclick = function(e) {
      if(e.target===this) {
        document.getElementById("pay-popup-bg").style.display = "none";
        document.getElementById("pay-popup-content").innerHTML = "";
        document.body.style.overflow = "";
      }
    };
    // Confetti animation
    function confetti() {
      const canvas = document.getElementById("confetti-canvas");
      canvas.style.display = "block";
      const ctx = canvas.getContext("2d");
      let W = window.innerWidth, H = window.innerHeight;
      canvas.width = W; canvas.height = H;
      let confs = [];
      for(let i=0;i<64;i++) confs.push({
        x:Math.random()*W, y:Math.random()*-H,
        r:8+Math.random()*12, d:4+Math.random()*4,
        color:`hsl(${Math.floor(330+Math.random()*80)},${80+Math.random()*18}%,${60+Math.random()*32}%)`,
        tilt:Math.random()*16, tiltAngle:Math.random()*360, tiltAngleInc:.09+Math.random()*.08
      });
      let frame = 0;
      function drawConfetti(){
        ctx.clearRect(0,0,W,H);
        confs.forEach(c=>{
          ctx.beginPath();
          ctx.lineWidth = c.d;
          ctx.strokeStyle = c.color;
          ctx.moveTo(c.x + c.tilt + Math.sin(frame/12)*4, c.y);
          ctx.lineTo(c.x + c.tilt, c.y + c.r);
          ctx.stroke();
        });
        updateConfetti();
        frame++;
        if(frame<85) requestAnimationFrame(drawConfetti);
        else canvas.style.display="none";
      }
      function updateConfetti(){
        for(let i=0;i<confs.length;i++){
          let c = confs[i];
          c.y += Math.cos(c.d) + 2 + c.d/2;
          c.tiltAngle += c.tiltAngleInc;
          c.tilt = Math.sin(c.tiltAngle-((i%3)*2))*10;
        }
      }
      drawConfetti();
    }
    // REVIEWS
    function renderReviews() {
      const list = document.getElementById("reviews-list");
      if (reviews.length === 0) {
        list.innerHTML = `<div style="text-align:center; color:#a971a1; font-size:1.13em;">No reviews yet. Be the first!</div>`;
      } else {
        list.innerHTML = "";
        reviews.slice().reverse().forEach((r, i) => {
          const div = document.createElement("div");
          div.className = "review-card";
          div.style.animationDelay = `${0.06 * i + 0.12}s`;
          div.innerHTML = `
            <span class="reviewer">
              <span class="review-rating">${starRating(r.rating)}</span>
              ${escapeHtml(r.name)}
            </span>
            <div class="review-text">${escapeHtml(r.text)}</div>
            <div class="review-date">${escapeHtml(r.date)}</div>
          `;
          list.appendChild(div);
        });
      }
      renderStats();
      localStorage.setItem("sourmarket_reviews", JSON.stringify(reviews));
    }
    function starRating(n){
      let s="";
      for(let i=1;i<=5;i++)
        s+=i<=n?`<svg class="star-full" viewBox="0 0 20 20"><polygon points="10,1 13,7 19,7.3 14.5,11.7 16,18 10,14.2 4,18 5.5,11.7 1,7.3 7,7"/></svg>`:`<svg class="star-empty" viewBox="0 0 20 20"><polygon points="10,1 13,7 19,7.3 14.5,11.7 16,18 10,14.2 4,18 5.5,11.7 1,7.3 7,7"/></svg>`;
      return s;
    }
    renderReviews();
    function addReview(e) {
      e.preventDefault();
      const name = document.getElementById("review-name").value.trim();
      const rating = +document.getElementById("review-rating").value;
      const text = document.getElementById("review-text").value.trim();
      const err = document.getElementById("review-error");
      err.innerText = "";
      if(name.length < 2) {err.innerText="Name must be at least 2 characters.";return false;}
      if(text.length < 8) {err.innerText="Review must be at least 8 characters.";return false;}
      if(text.length > 300) {err.innerText="Keep your review under 300 characters.";return false;}
      reviews.push({
        name: escapeHtml(name),
        rating: rating,
        text: escapeHtml(text),
        date: (new Date()).toISOString().split("T")[0]
      });
      document.getElementById("review-form").reset();
      err.innerText="Thank you for your review!";
      confetti();
      setTimeout(()=>{err.innerText="";},1700);
      renderReviews();
      return false;
    }
    function escapeHtml(t) { return t.replace(/[&<>"']/g, s => ({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[s])); }
    // Section nav + animated transitions
    let sectionOrder = ["home","products","reviews"];
    function switchSection(name) {
      sectionOrder.forEach(id => {
        const sec = document.getElementById(id);
        if(id === name) {
          sec.style.display = "block";
          setTimeout(()=>sec.classList.add("visible"),20);
        } else {
          sec.classList.remove("visible");
          setTimeout(()=>sec.style.display = "none",420);
        }
        document.querySelectorAll('nav a').forEach(a => {
          a.classList.toggle("active", a.getAttribute('href') === "#" + name);
        });
      });
      document.getElementById(name).scrollIntoView({behavior:"smooth"});
    }
    window.onload = function() {
      if(location.hash && ["#home","#products","#reviews"].includes(location.hash)){
        switchSection(location.hash.substring(1));
      } else {
        switchSection('home');
      }
      renderStats();
      window.addEventListener("scroll", handleTopBtn);
    }
    window.onhashchange = function() {
      if(location.hash && ["#home","#products","#reviews"].includes(location.hash)){
        switchSection(location.hash.substring(1));
      }
    }
    // Admin panel
    function toggleAdmin(){
      const p = document.getElementById("admin-panel");
      p.style.display = (p.style.display==="flex")?"none":"flex";
    }
    function resetStats(){
      stats = {sold:32,customers:14};
      localStorage.setItem("sourmarket_stats",JSON.stringify(stats));
      isCustomer=false;localStorage.setItem("sourmarket_isCustomer","0");
      renderStats();
      alert("Stats reset!");
    }
    function clearReviews(){
      reviews = [];
      localStorage.setItem("sourmarket_reviews",JSON.stringify([]));
      renderReviews();
      alert("All reviews deleted!");
    }
    document.getElementById("admin-panel").style.display="none";
    // FAQ
    function toggleFaq(el){
      el.classList.toggle("active");
      let nxt = el.nextElementSibling;
      if(nxt && nxt.classList.contains("faq-a")) {
        if(nxt.style.display==="block"){nxt.style.display="none";}
        else {nxt.style.display="block";}
      }
    }
    // Back to Top Button
    function handleTopBtn() {
      document.getElementById("top-btn").style.display = (window.scrollY > 240) ? "block" : "none";
    }
  </script>
</body>
</html>
